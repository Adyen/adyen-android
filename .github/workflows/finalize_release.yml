name: Finalize release

on:
  push:
    branches:
      - 'release-notes'

jobs:
  fetch_version_name:
    name: Fetch version name
    uses: ./.github/workflows/fetch_version_name_from_release_notes.yml
  update_release_notes:
    name: Update release notes
    uses: ./.github/workflows/update_release_notes.yml
    secrets: inherit
    needs: fetch_version_name
    with:
      version-name: ${{ needs.fetch_version_name.outputs.version-name }}
  publish_github_release:
    name: Publish Github release
    uses: ./.github/workflows/publish_github_release.yml
    secrets: inherit
    needs: [fetch_version_name, update_release_notes]
    with:
      version-name: ${{ needs.fetch_version_name.outputs.version-name }}
  cleanup_release:
    name: Clean up release
    uses: ./.github/workflows/cleanup_release.yml
    secrets: inherit
    needs: [fetch_version_name, publish_github_release]
    with:
      version-name: ${{ needs.fetch_version_name.outputs.version-name }}
